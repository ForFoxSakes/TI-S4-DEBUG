# ðŸ“˜ Module Design â€“ Onderzeedrone Simulatie

## Inleiding

Dit document beschrijft het moduleontwerp van de onderzeedrone simulatie en vormt de brug tussen het architectuurdesign en de uiteindelijke implementatie. In deze fase wordt elke component uit de systeemarchitectuur verder uitgewerkt tot concrete modules, met specifieke verantwoordelijkheden, interfaces, interne structuur, datastructuren, algoritmes en teststrategieÃ«n. De uitwerking volgt het V-model, waarbij voor elke module ook de bijbehorende verificatie- en validatiefases zijn gedefinieerd.

De opbouw van dit document is gelijk aan die van eerdere fasen, om consistentie en traceerbaarheid te waarborgen.

---

## Overzicht Modulestructuur

De onderzeedrone simulatie bestaat uit de volgende hoofdmodules:

| Nr | Module              | Verantwoordelijkheid                                            |
| -- | ------------------- | --------------------------------------------------------------- |
| 1  | Simulatie Engine    | Simulatie van fysica en onderwateromgeving                      |
| 2  | Hardware Emulator   | Virtuele dronehardware inclusief sensoren en actuatoren         |
| 3  | User Interface (UI) | Gebruikersinteractie en visualisatie                            |
| 4  | Scenario Manager    | Beheer en uitvoering van trainingsscenario's                    |
| 5  | Firmware Interface  | Testen en integreren van firmware zonder fysieke drone          |
| 6  | Logging & Analytics | Registratie van prestaties en gegenereerde data                 |
| 7  | Security Manager    | Authenticatie en autorisatie                                    |
| 8  | Data Storage        | Opslag van configuraties, logs, scenarioâ€™s en prestatiegegevens |

De onderlinge relaties worden bepaald door afhankelijkheden (bijvoorbeeld UI â†’ Scenario Manager â†’ Simulatie Engine) en worden visueel ondersteund in de architectuurdiagrammen.

---

## Module 1: Simulatie Engine

### Verantwoordelijkheid

* Simuleert fysische krachten zoals stroming, weerstand, drijfvermogen
* Beheert omgevingscondities en storingen

### Interne Structuur

* **PhysicsEngine** â€“ berekent krachten, massa, versnelling
* **EnvironmentSimulator** â€“ bepaalt zichtbaarheid, stroming, temperatuur
* **CollisionDetector** â€“ detecteert en behandelt botsingen
* **FaultModule** â€“ injecteert storingen voor trainingsdoeleinden

### Interfaces

* Input: scenario-configuratie (gRPC), besturingscommando's (MQTT)
* Output: sensorwaarden (WebSocket), statusupdates (REST)

### Visualisatie

```plaintext
[ScenarioManager] â†’ [SimulatieEngine] â†’ [HardwareEmulator]
                                    â†“
                             [Logging&Analytics]
```

### Teststrategie

* Unit: PhysicsEngine.calcForce(), EnvironmentSimulator.simulate()
* Integratie: met HardwareEmulator en UI
* Systeem: Volledige trainingssessie met storingen

---

## Module 2: Hardware Emulator

### Verantwoordelijkheid

* Emuleert hardwarecomponenten zoals sensoren, actuatoren en elektronica

### Interne Structuur

* **SensorSimulator** â€“ camera, sonar, dieptemeter, temperatuur
* **ActuatorSimulator** â€“ motoren, grijpers
* **InterfaceAdapter** â€“ vertaalt firmwareopdrachten naar simulatie
* **FaultSimulator** â€“ defecten en uitval emuleren

### Interfaces

* Input: commandoâ€™s van firmware, UI en scenarioâ€™s
* Output: virtuele sensorwaarden

### UML (samenvatting)

```plaintext
+-------------------+
| HardwareEmulator  |
|-------------------|
| +readSensors()    |
| +applyCommands()  |
+-------------------+
```

### Teststrategie

* Unit: Sensoroutput bij gegeven input
* Integratie: Firmware-communicatie
* Systeem: Drone-interactie bij gesimuleerd defect

---

## Module 3: User Interface (UI)

### Verantwoordelijkheid

* Visualisatie en besturing van de simulatie door eindgebruikers

### Componenten

* **Dashboard** â€“ overzichten en realtime status
* **ControlPanel** â€“ besturing drone
* **ScenarioSelector** â€“ scenario kiezen en starten
* **3D Visualisatie** â€“ rendering via Three.js

### Interfaces

* Input: gebruikerstriggers, instellingen
* Output: REST en WebSocket richting backend

### Visualisatie

```plaintext
[Gebruiker] â†’ [React UI] â†’ [REST API] â†’ [ScenarioManager]
                             â†“
                       [WebSocket]: Real-time status
```

### Teststrategie

* Unit: interactiecomponenten renderen correct
* Integratie: backendcommunicatie (selectie, visualisatie)
* Acceptatie: brandweer usability-test

---

## Module 4: Scenario Manager

### Verantwoordelijkheid

* Beheert scenarioâ€™s: selectie, uitvoering, opvolging

### Structuur

* **ScenarioLibrary** â€“ opgeslagen scenarioâ€™s
* **RuntimeEngine** â€“ actieve scenario-uitvoering en triggers

### Interfaces

* Input: UI selectie, instellingswijzigingen
* Output: parameters naar simulatie (via gRPC)

### Visualisatie

```plaintext
[UI] â†’ [ScenarioManager] â†’ [SimulatieEngine]
```

### Teststrategie

* Unit: scenario laden, valideren
* Integratie: overdracht van parameters
* Systeem: complex scenario uitvoeren

---

## Module 5: Firmware Interface

### Verantwoordelijkheid

* Firmware testen in een virtuele omgeving

### Structuur

* **FirmwareLoader** â€“ upload en initiatie
* **HALInterface** â€“ Hardware Abstraction Layer
* **DebugConsole** â€“ logging en debuggegevens tonen

### Interfaces

* Input: firmwarecode
* Output: logs, realtime feedback

### Teststrategie

* Unit: HAL-methodes gesimuleerd
* Integratie: met Hardware Emulator
* Systeem: firmwaregestuurde scenario's

---

## Module 6: Logging & Analytics

### Verantwoordelijkheid

* Vastleggen van simulatiegegevens en analyse van prestaties

### Structuur

* **DataCollector** â€“ verzamelt logs
* **AnalyticsProcessor** â€“ analyseert prestaties
* **ReportGenerator** â€“ visualiseert resultaten

### Interfaces

* Input: simulatiegegevens
* Output: rapporten, feedback naar UI

### Visualisatie

```plaintext
[SimulatieEngine] + [UI] â†’ [Logging] â†’ [Rapportage]
```

### Teststrategie

* Unit: opslag en aggregatie van data
* Integratie: synchronisatie met simulatie en UI
* Systeem: eindrapport bij afronding sessie

---

## Module 7: Security Manager

### Verantwoordelijkheid

* Authenticatie, autorisatie en audit logging

### Structuur

* **AuthModule** â€“ gebruikersverificatie
* **PermissionService** â€“ roltoegang bepalen
* **AuditLogger** â€“ toegangslogboek

### Interfaces

* Input: gebruikerslogin
* Output: JWT, toegangsfouten

### Technologie

* OAuth 2.0, JWT, bcrypt hashing

### Teststrategie

* Unit: verificatie-invoer
* Integratie: UI toegang, firmware beveiliging
* Systeem: test ongeoorloofde toegangspogingen

---

## Module 8: Data Storage

### Verantwoordelijkheid

* Beheer en opslag van alle persistente gegevens

### Structuur

* **ScenarioDB** â€“ PostgreSQL voor statische data
* **LogRepo** â€“ InfluxDB voor tijdreeksen
* **ConfigStore** â€“ JSON-bestanden voor sessieconfiguraties

### Interfaces

* Input: opslagaanvragen
* Output: queries voor rapportage en configuratie

### Visualisatie

```plaintext
[Alle modules] â†’ [DataStorage]
```

### Teststrategie

* Unit: I/O testen van opslag
* Integratie: Logging, Scenario Manager
* Systeem: gegevensrestauratie en queryperformance

---

## Conclusie

Dit module design biedt een gedetailleerde uitwerking van de technische structuur, logica en verantwoordelijkheden van de onderzeedrone simulatie. Per module zijn concrete testvormen voorzien binnen het V-model. Dit ontwerp vormt een solide basis voor gestructureerde implementatie, testautomatisering en iteratieve uitbreiding. De consistentie met eerdere fasen (systeem- en architectuurdesign) waarborgt traceerbaarheid en beheersbaarheid gedurende het ontwikkeltraject.
